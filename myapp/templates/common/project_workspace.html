<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Project Workspace | InternConnect</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #0f172a; --accent: #2563eb; --shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }

        body {
            background: linear-gradient(rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.9)),
                        url('https://images.unsplash.com/photo-1522071820081-009f0129c71c?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80');
            background-size: cover; background-attachment: fixed;
            font-family: 'Segoe UI', sans-serif; padding: 40px 20px; margin: 0;
        }

        .container { max-width: 900px; margin: 0 auto; }

        /* Header */
        .header-card {
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px);
            padding: 30px; border-radius: 16px; color: white; margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center;
        }
        .header-card h1 { margin: 0; font-size: 1.8rem; }
        .btn-back { color: rgba(255,255,255,0.7); text-decoration: none; font-weight: 600; transition: 0.3s; }
        .btn-back:hover { color: white; text-decoration: underline; }

        /* Main Glass Card */
        .glass-card {
            background: rgba(255, 255, 255, 0.98); border-radius: 16px; padding: 40px; box-shadow: var(--shadow);
        }

        .section-title {
            color: var(--primary); border-bottom: 2px solid #f1f5f9;
            padding-bottom: 15px; margin-bottom: 25px; font-size: 1.3rem; font-weight: 800;
            display: flex; align-items: center; gap: 10px;
        }

        /* Form Elements */
        label { display: block; font-weight: 700; color: #475569; margin-bottom: 8px; margin-top: 20px; }
        input[type="text"], textarea { width: 100%; padding: 14px; border: 1px solid #cbd5e1; border-radius: 8px; box-sizing: border-box; font-size: 1rem; transition: 0.3s; }
        input:focus, textarea:focus { border-color: var(--accent); outline: none; box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }

        .file-box {
            background: #f8fafc; border: 2px dashed #cbd5e1; padding: 25px; border-radius: 10px;
            text-align: center; margin-bottom: 25px; transition: 0.3s;
        }
        .file-box:hover { border-color: var(--accent); background: #eff6ff; }

        .btn { padding: 14px 30px; border-radius: 8px; font-weight: bold; cursor: pointer; border: none; font-size: 1rem; transition: 0.3s; display: inline-block; text-decoration: none; }
        .btn-primary { background: var(--accent); color: white; width: 100%; }
        .btn-primary:hover { background: #1d4ed8; transform: translateY(-2px); }

        .download-link {
            display: inline-flex; align-items: center; gap: 10px;
            background: #e0f2fe; color: #0369a1; padding: 12px 20px;
            border-radius: 8px; text-decoration: none; font-weight: 700; font-size: 0.95rem;
            border: 1px solid #bae6fd; transition: 0.3s;
        }
        .download-link:hover { background: #0ea5e9; color: white; border-color: #0ea5e9; }

        .status-box { margin-top: 10px; padding: 15px; border-radius: 8px; font-size: 0.95rem; }
        .status-success { background: #dcfce7; color: #166534; border: 1px solid #bbf7d0; }
        .status-waiting { background: #f3f4f6; color: #6b7280; border: 1px solid #e5e7eb; font-style: italic; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-card">
            <div>
                <h1>Project Workspace</h1>
                <p style="opacity:0.8; margin:5px 0 0;">{{ app.internship.positionTitle }} â€¢ {{ app.user.name }}</p>
            </div>
            <a href="javascript:history.back()" class="btn-back">&larr; Back to Dashboard</a>
        </div>

        <div class="glass-card">

            {% if user_role == 'employer' %}

            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="section-title"><i class="fas fa-bullhorn"></i> Assign Project & Resources</div>

                <label>Project Title</label>
                <input type="text" name="title" value="{{ project.title }}" placeholder="e.g. Build a Marketing Strategy" required>

                <label>Detailed Instructions / Classes</label>
                <textarea name="description" rows="6" placeholder="Describe the task steps, requirements, or paste video class links here..." required>{{ project.description|default:'' }}</textarea>

                <label>Upload Project Files (PDFs, Zip, Docs)</label>
                <div class="file-box">
                    <input type="file" name="company_file">
                    {% if project.company_file %}
                        <div style="margin-top:15px;">
                            <span style="color:#64748b;">Current File:</span>
                            <a href="{{ project.company_file.url }}" target="_blank" style="color:var(--accent); font-weight:bold;">{{ project.company_file.name }}</a>
                        </div>
                    {% endif %}
                </div>

                <button type="submit" class="btn btn-primary">Update Project & Send to Student</button>
            </form>

            <div style="margin-top: 50px; padding-top: 30px; border-top: 2px solid #f1f5f9;">
                <div class="section-title"><i class="fas fa-folder-open"></i> Student Submission</div>

                {% if project.student_file %}
                    <div class="status-box status-success">
                        <i class="fas fa-check-circle"></i> <strong>Success:</strong> The student has submitted their work.
                    </div>
                    <div style="margin-top: 20px;">
                        <a href="{{ project.student_file.url }}" class="download-link" download>
                            <i class="fas fa-download"></i> Download Student Work
                        </a>
                    </div>
                {% else %}
                    <div class="status-box status-waiting">
                        <i class="fas fa-clock"></i> Waiting for student to upload their work...
                    </div>
                {% endif %}
            </div>

            {% else %}

            <div>
                <div class="section-title"><i class="fas fa-tasks"></i> Project Instructions</div>
                <h3 style="margin-bottom:15px; color:#1e293b; font-size:1.5rem;">{{ project.title }}</h3>

                <div style="background:#f8fafc; padding:20px; border-radius:10px; border:1px solid #e2e8f0; line-height:1.8; color:#334155; white-space: pre-wrap;">{{ project.description|default:"No instructions provided yet." }}</div>

                {% if project.company_file %}
                    <div style="margin-top:25px;">
                        <label style="margin-top:0;">Attached Resources:</label>
                        <a href="{{ project.company_file.url }}" class="download-link" download>
                            <i class="fas fa-file-download"></i> Download Project Files
                        </a>
                    </div>
                {% endif %}
            </div>

            <div style="margin-top: 50px; padding-top: 30px; border-top: 2px solid #f1f5f9;">
                <div class="section-title"><i class="fas fa-upload"></i> Submit Your Work</div>

                <form method="POST" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="file-box">
                        <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: #cbd5e1; margin-bottom: 15px;"></i>
                        <p style="color:#64748b; margin-bottom:15px;">Upload your completed project (Zip, PDF, Doc)</p>
                        <input type="file" name="student_file" required>

                        {% if project.student_file %}
                            <div style="margin-top:15px; color:#166534; font-weight:bold; background:#dcfce7; padding:10px; border-radius:6px; display:inline-block;">
                                <i class="fas fa-check"></i> File uploaded: {{ project.student_file.name }}
                            </div>
                        {% endif %}
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Project</button>
                </form>
            </div>
            {% endif %}

        </div>
    </div>
</body>
</html>